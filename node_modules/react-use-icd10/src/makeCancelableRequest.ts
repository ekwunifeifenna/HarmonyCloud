import axios from 'axios'

const url = `https://clinicaltables.nlm.nih.gov/api/icd10cm/v3/search`

const makeCancelableRequest = () => {
  let call: any
  return async (keyword: string): Promise<any> => {
    try {
      if (call) call.cancel()
      call = axios.CancelToken.source()
      const params = { sf: 'code,name', terms: keyword }
      return axios.get(url, { cancelToken: call.token, params })
    } catch (error) {
      throw error
    }
  }
}

export default makeCancelableRequest
